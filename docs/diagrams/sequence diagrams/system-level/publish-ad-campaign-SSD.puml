@startuml

title <u>System Sequence Diagram</u>\nAdvertiser Publish Ad Campaign

actor Advertiser
participant System
actor "Media Owner" as MediaOwner
participant "<<external>>\nGmail SMTP" as GmailAPI

ref over System, Advertiser
    <i>UC- Create Ad Campaign Use Case</i>
end ref
ref over System, Advertiser
    <i>UC- Browse Media Use Case</i>
end ref
ref over System, Advertiser
    <i>UC- View Media Listing Details Use Case</i>
end ref

Advertiser -> System: reserveMedia(mediaId, adCampaignId, startDate, endDate)


alt Validation succeeds
    System --> Advertiser: reservationDetails
else Validation fails
    System --> Advertiser: validationError
end
note left of System
  reservationDetails contains:
  - mediaId
  - campaignId
  - startDate
  - endDate
end note


Advertiser -> System: confirmReservation()

alt Reservation Succeeds
    System --> Advertiser: reservationCreated
else Reservation Fails
    System --> Advertiser: reservationError
end


note left of System
  Reservation created with PENDING status.
  Media Owner approval required.
end note

ref over System, MediaOwner
    <i>UC- Approve Reservation Use Case</i>
    (Media Owner approves request)
end ref

ref over System, Advertiser
    <i>Advertiser views his reservations</i>
    <i>(UC- View Reservations Use Case)</i>
end ref


Advertiser -> System: submitPayment(paymentInfo)
note right of Advertiser
  paymentInfo contains:
  - paymentMethodId
  - billingDetails
end note

alt Payment succeeds
    System --> Advertiser: paymentConfirmation
else Payment fails
    System --> Advertiser: paymentError
end

note left of System
  paymentConfirmation contains:
  - reservationId
  - campaignStartDate
  - campaignEndDate
  - activeStatus
end note

System -> GmailAPI: sendSimpleEmail(to, subject, body)
GmailAPI -> MediaOwner: emailNotification
@enduml