@startuml
!theme plain
hide circle
top to bottom direction
!pragma useVerticalIf on
skinparam dpi 350
skinparam packageStyle rectangle
skinparam rectangle {
  BackgroundColor #f7f4eb
  BorderColor Black
}

' === DDD DEFINITIONS ===
!define ENTITY(e) class e <<Entity>>
!define AGGREGATE(a) class a <<Aggregate>>
!define AGGREGATE_ROOT(ar) class ar <<Aggregate Root>>
!define VALUE_OBJECT(vo) class vo <<Value Object>>
!define ENUM(enum) class enum <<Enum>>

title Envision Ad Platform - Domain Driven Design Domain Model

' ===============================
' Media
' ===============================
package "Media Subdomain" #LightGreen {
  AGGREGATE_ROOT(Media) #LightBlue {
    title: String
    estimatedDailyViews: Int
    pricePerHour: Decimal
    width: Decimal
    height: Decimal
    resolution: Decimal
    image: URL
    mediaCorners: double[4]
  }

  note right of Media::height
    Width and height are in CM.
  end note

  ENTITY(MediaType) #LightBlue {
    name: String
    description: String
  }

  VALUE_OBJECT(MediaTypeIdentifier) #Bisque {
    mediaTypeId: UUID
  }

  ENUM(ApprovalStatus) #Orange {
    PENDING
    REJECTED
    APPROVED
  }

  ENUM(ListingStatus) #Orange {
    DRAFT
    LISTED
    UNLISTED
  }

  VALUE_OBJECT(MediaIdentifier) #Bisque {
    mediaId: UUID
  }

  AGGREGATE(MediaLocation) #LightBlue {
    name: String
    description: String
    country: String
    province: String
    city: String
    postalCode: String
    latitude: Float
    longitude: Float
  }

  VALUE_OBJECT(MediaLocationIdentifier) #Bisque {
      mediaLocationId: UUID
}

  MediaType "1" o--> "1" MediaTypeIdentifier
  Media "1" o--> "1" MediaIdentifier
  Media "1" o--> "1" MediaTypeIdentifier
  Media "1" o--> "1" ListingStatus
  Media "1" o--> "1" ApprovalStatus
  MediaLocation "1" o--> "*" "MediaIdentifier"
  MediaLocation "1" o--> "1" "MediaLocationIdentifier"
}

' ===============================
' Advertiser
' ===============================
package "Advertising Subdomain" #LightCoral {
  AGGREGATE_ROOT(AdvertisementCampaign) #LightBlue {
    startDate: Date
    endDate: Date
    budget: Decimal
  }

  AGGREGATE(Advertisement) #LightBlue {
    mediaId: UUID
    screenTimeMinutes: Int
    cost: Decimal
    approvedByOwner: Boolean
  }

  ENUM(Status) #Orange {
    ACTIVE
    PENDING
    REJECTED
    EXPIRED
  }

  VALUE_OBJECT(AdIdentifier) #Bisque {
    adId: UUID
  }

  VALUE_OBJECT(AdCampaignIdentifier) #Bisque {
    adCampaignId: UUID
  }

  AdvertisementCampaign "1" o--> "1" AdCampaignIdentifier
  AdvertisementCampaign "1" o--> "1..*" AdIdentifier
  AdvertisementCampaign "1" o--> "1" Status
  Advertisement "1" o--> "1" AdIdentifier
}

' ===============================
' TRANSACTIONS
' ===============================
package "Transactions Subdomain" #LightPink {
  AGGREGATE_ROOT(Transaction) #LightBlue {
    amount: Decimal
    timestamp: DateTime
  }

  ENTITY(Invoice) #LightBlue {
    dueDate: Date
    paid: Boolean
  }

   ENUM(Status) #Orange {
     SUCCESS
     PENDING
     FAILED
   }

  VALUE_OBJECT(TransactionIdentifier) #Bisque {
    transactionId: UUID
  }

  VALUE_OBJECT(InvoiceIdentifier) #Bisque {
    invoiceId: UUID
  }

  Transaction "1" o--> "1" InvoiceIdentifier
  Transaction "1" o--> "1" TransactionIdentifier
  Transaction "1" o--> "1" Status
  Invoice "1" o--> "1" InvoiceIdentifier
}

' ===============================
' MODERATION
' ===============================
package "Moderation Subdomain" #LightCyan {
  AGGREGATE_ROOT(UserReport) #LightBlue {
    reason: String
    description: String
    proof: URL
  }

  ENUM(Status) #Orange {
    PENDING
    APPROVED
    REJECTED
  }

   VALUE_OBJECT(UserReportIdentifier) #Bisque {
     userReportId: UUID
   }

  UserReport "1" o--> "1" UserReportIdentifier
  UserReport "1" o--> "1" Status
}

' ===============================
' ANALYTICS
' ===============================
package "Analytics Subdomain" #lightyellow {
  AGGREGATE_ROOT(Report) #LightBlue {
    generatedAt: DateTime
  }

  AGGREGATE(ReportData) #LightBlue {
    value: String
    name: String
    description: String
  }

  VALUE_OBJECT(ReportIdentifier) #Bisque {
    reportID: UUID
  }

  VALUE_OBJECT(ReportDataIdentifier) #Bisque {
    reportDataId: UUID
  }

  Report "1" o--> "1" ReportIdentifier
  Report "1" o--> "1..*" ReportDataIdentifier
  ReportData "1" o--> "1" ReportDataIdentifier
}

' ===============================
' CUSTOMER
' ===============================
package "Customer Subdomain" #Lavender {
  AGGREGATE_ROOT(Customer) #LightBlue {
    FirstName: String
    LastName: String
    email: String
    phone: String
  }

  AGGREGATE(Business)  #LightBlue {
    name: String
    employees: int
  }

  VALUE_OBJECT(CustomerIdentifier) #Bisque {
    customerId: UUID
  }

  VALUE_OBJECT(BusinessIdentifier) #Bisque {
    businessId: UUID
  }

  VALUE_OBJECT(BillingAddress) #Bisque {
    street: String
    city: String
    province: String
    postalCode: String
  }

  Business "1" o--> "1..*" CustomerIdentifier
  Customer "1" o--> "1" CustomerIdentifier

  Business "1" o--> "1" BusinessIdentifier
  Business "1" o--> "1" BillingAddress
}

' ===============================
' REVIEWS
' ===============================

Report "1" o--> "1" BusinessIdentifier
Media "1" o--> "1" BusinessIdentifier
AdvertisementCampaign "1" o--> "1" BusinessIdentifier
Transaction "1" o--> "1" BusinessIdentifier
UserReport "1" o--> "1" BusinessIdentifier

@enduml
